<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- ✅ CSS -->
  <link rel="stylesheet" href="./css/bootstrap.min.css">
  <link rel="stylesheet" href="./css/kiosk.css">
  <link rel="stylesheet" href="./css/splash.css">
  <link rel="stylesheet" href="./css/service.css">
  <link rel="stylesheet" href="./css/menu.css">
  <link rel="stylesheet" href="./css/payment-method.css">
  <link rel="stylesheet" href="./css/qr-code-payment.css">
</head>

<body class="bg-light">
  <div id="kioskApp"></div>

  <!-- templates injected here by kiosk_main.py -->

  <!-- ✅ Vendor JS first -->
  <script defer src="./assets/js/bootstrap.bundle.min.js"></script>

  <!-- ✅ Vue (optional, safe to keep) -->
  <script defer src="./assets/js/vue.global.prod.js"></script>

  <!-- ✅ Core -->
  <script defer src="./js/core/tpl.js"></script>
  <script defer src="./js/core/api.js"></script>
  <script defer src="./js/core/router.js"></script>

  <!-- ✅ Modules -->
  <script defer src="./js/modules/splash.js"></script>
  <script defer src="./js/modules/service.js"></script>
  <script defer src="./js/modules/menu.js"></script>


  <!-- later add: service.js, menu.js, product.js ... -->

  <!-- ✅ Start app last -->
  <script defer src="./app.js"></script>

<template id="tpl-category">
<div
  v-for="c in store.categories"
  :key="c.id"
  v-if="c"
  class="menu-category"
  :class="{ active: c.id === store.catalog.categoryId }"
  @click="selectCategory(c.id)"
>
  <img
    class="menu-category-img"
    :src="img(c)"
    alt=""
  />
  <div class="menu-category-name">{{ c.name }}</div>
</div>

</template>


<template id="tpl-checkout-footer">
<div class="checkout-footer">
  <div class="footer-left">
    <button class="btn btn-light btn-lg w-100" @click="$emit('back')">
      Back
    </button>
  </div>

  <div class="footer-center">
    <div class="footer-total-label">Total</div>
    <div class="footer-total-amount">
      $ {{ total.toFixed(2) }}
    </div>
    <div class="footer-total-items">
      {{ count }} items
    </div>
  </div>

  <div class="footer-right">
    <button
      class="btn btn-warning btn-lg w-100"
      :disabled="count === 0"
      @click="$emit('checkout')"
    >
      Checkout
    </button>
  </div>
</div>

</template>


<template id="tpl-menu">

  <div class="menu-page">

    <!-- ===== CATEGORY ROW ===== -->
    <section class="row-scroll categories-row">
      <button
        v-for="c in safeCategories"
        :key="c.id"
        class="chip-card"
        :class="{ active: Number(store.catalog.categoryId) === Number(c.id) }"
        @click="selectCategory(c.id)"
      >
        <img
          class="chip-img"
          :src="img(c.image_path)"
          @error="e => e.target.src='./assets/placeholder.png'"
          alt=""
        >
        <div class="chip-text">{{ c.name }}</div>
      </button>
    </section>

    <!-- ===== SUB-CATEGORY ROW ===== -->
    <section class="row-scroll subcategories-row">
      <button
        v-for="s in safeSubCategories"
        :key="s.id"
        class="chip-pill"
        :class="{ active: Number(store.catalog.subCategoryId) === Number(s.id) }"
        @click="selectSubCategory(s.id)"
      >
        <img
          class="pill-img"
          :src="img(s.image_path)"
          @error="e => e.target.src='./assets/placeholder.png'"
          alt=""
        >
        <span class="pill-text">{{ s.name }}</span>
      </button>
    </section>

    <!-- ===== PRODUCT GRID ===== -->
    <main class="products-area">
      <div class="products-grid">
        <div
          v-for="p in safeProducts"
          :key="p.id"
          class="prd-card"
          @click="openProduct(p)"
        >
          <img
            class="prd-img"
            :src="img(p.image_path)"
            @error="e => e.target.src='./assets/placeholder.png'"
            alt=""
          >
          <div class="prd-body">
            <div class="prd-name">{{ p.name }}</div>
            <div class="prd-desc" v-if="p.description">{{ p.description }}</div>
            <div class="prd-price">$ {{ Number(p.base_price || 0).toFixed(2) }}</div>
          </div>
        </div>
      </div>

      <div v-if="!safeProducts.length && !store.loading" class="empty-state">
        No products
      </div>
    </main>

    <!-- ===== STICKY CART FOOTER ===== -->
    <footer class="cart-footer">
      <div class="cart-inner">
        <div class="cart-left">
          <div class="cart-label">Total</div>
          <div class="cart-total">$ {{ total.toFixed(2) }}</div>
          <div class="cart-items">{{ count }} items</div>
        </div>

        <button class="btn-pay" :disabled="count === 0" @click="goCheckout">
          Proceed to Payment
        </button>
      </div>
    </footer>

  </div>


</template>


<template id="tpl-product">
<div
  v-for="p in store.products"
  :key="p.id"
  v-if="p"
  class="product-card"
  @click="openProduct(p)"
>
  <img
    class="product-img"
    :src="img(p)"
    alt=""
  />
  <div class="product-info">
    <div class="product-name">{{ p.name }}</div>
    <div class="product-price">{{ formatMoney(p.base_price) }}</div>
  </div>
</div>

</template>


<template id="tpl-service">
<div class="svc-screen">
  <button class="btn btn-outline-secondary svc-back" @click="goSplash">
    Splash
  </button>

  <div class="svc-container">
    <h1 class="svc-title">Where do you want to eat?</h1>
    <p class="svc-subtitle">Choose Options</p>

    <div class="svc-options">
      <!-- Dine In -->
      <div class="svc-card"
           :class="{ selected: service === 'dine_in' }"
           @click="selectService('dine_in')">
        <div class="svc-icon">
          <img src="./assets/service/dine_in.png" alt="Dine In">
        </div>
        <div class="svc-card-title">Dine In</div>
        <div class="svc-card-desc">Enjoy your meal here</div>
      </div>

      <!-- Take Away -->
      <div class="svc-card"
           :class="{ selected: service === 'take_away' }"
           @click="selectService('take_away')">
        <div class="svc-icon">
          <img src="./assets/service/take_away.png" alt="Take Away">
        </div>
        <div class="svc-card-title">Take Away</div>
        <div class="svc-card-desc">Pack your order to go</div>
      </div>
    </div>

    <div class="svc-actions">
      <button class="btn btn-success svc-continue"
              :disabled="!service"
              @click="continueService">
        Continue
      </button>
    </div>
  </div>
</div>

</template>


<template id="tpl-splash">
<div class="splash-wrap">

  <div id="splashCarousel"
       class="carousel slide carousel-fade vh-100"
       data-bs-touch="false"
       data-bs-pause="false">

    <div class="carousel-inner vh-100">
      <div class="carousel-item active vh-100">
        <img src="./assets/splash/1.png" class="d-block w-100 splash-img" alt="1">
      </div>
      <div class="carousel-item vh-100">
        <img src="./assets/splash/2.png" class="d-block w-100 splash-img" alt="2">
      </div>
      <div class="carousel-item vh-100">
        <img src="./assets/splash/3.png" class="d-block w-100 splash-img" alt="3">
      </div>
      <div class="carousel-item vh-100">
        <img src="./assets/splash/4.png" class="d-block w-100 splash-img" alt="4">
      </div>
      <div class="carousel-item vh-100">
        <img src="./assets/splash/5.png" class="d-block w-100 splash-img" alt="5">
      </div>
    </div>

    <div class="carousel-indicators">
      <button type="button" data-bs-target="#splashCarousel" data-bs-slide-to="0" class="active"></button>
      <button type="button" data-bs-target="#splashCarousel" data-bs-slide-to="1"></button>
      <button type="button" data-bs-target="#splashCarousel" data-bs-slide-to="2"></button>
      <button type="button" data-bs-target="#splashCarousel" data-bs-slide-to="3"></button>
      <button type="button" data-bs-target="#splashCarousel" data-bs-slide-to="4"></button>
    </div>
  </div>

  <div class="splash-bottom d-flex justify-content-center align-items-center">
    <button class="btn btn-primary btn-lg w-50 py-3 fw-bold"
            @click="goService">
      Order Now
    </button>
  </div>

</div>

</template>


<template id="tpl-sub-category">
<div
  v-for="sc in store.subCategories"
  :key="sc.id"
  v-if="sc"
  class="menu-sub-category"
  :class="{ active: sc.id === store.catalog.subCategoryId }"
  @click="selectSubCategory(sc.id)"
>
  <img
    class="menu-sub-category-img"
    :src="img(sc)"
    alt=""
  />
  <div class="menu-sub-category-name">{{ sc.name }}</div>
</div>

</template>

</body>
</html>
